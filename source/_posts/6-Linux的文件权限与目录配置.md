title: Linux文件权限与目录配置
author: WENCHIH CHANG
author_id: wenchih99@github.com
date: 2020-12-02 10:56:46
tags: linux
language:
archives:
categories: [linux,Linux文件、目录与磁盘格式]
---
# 用户与用户组
<!--more-->
- 万能天神(root)
- 文件拥有者(owner):文件的主人
- 用户组(group):进行团队协作
- 其他人(others):相当于路人
- 用户记录文件
  - 所有用户相关信息都记录在/etc/passwd这个文件内
  - 个人密码记录在/etc/shadow文件内
  - 所有组名记录在/etc/group文件内

# Linux文件权限
- Linux文件属性
  - 执行命令:`ls -al 目录名`查看属性
    - ls是list缩写
    - -l是列出所有文件详细的权限与属性
    - -a是列出隐藏文件
  - 例子(各字段及其意思):
    |dr-xr-xr-x.|5|root|root|4096|3月31 09:53|boot|
    |-|-|-|-|-|-|-|
    |文件类型权限|链接数|文件拥有者|文件所属用户组|文件大小|文件最后修改日期|文件名|
- 文件属性各字段意思
  - 第一字段代表文件类型与权限
    - 例子
      |d|rwx|rwx|rwx|
      |-|-|-|-|
      |文件类型|文件拥有者权限|文件所属用户组权限|其他人权限|
  - 第二字段表示多少文件名链接到此节点
  - 第三字段表示这个文件或目录的拥有者
  - 第四字段表示这个文件所属用户组
  - 第五字段表示文件的容量大小,默认单位Bytes
  - 第六字段表示文件创建日期或是最近修改的时间
  - 第七字段为文件名
- 修改文件属性与权限
  - 权限
    - [r]代表可读(read)
    - [w]代表可写(write)
    - [x]代表可执行(execute)
    - 没有相应权限就用[-]表示
  - `chgrp`:修改文件所属用户组
    - 要被修改的组名必须要在/etc/group文件中存在
  - `chown`:修改文件拥有者
    - 既可以改文件拥有者也可改用户组,格式:`chown user:group file`,用冒号隔开
  - `chmod`:修改文件的权限,SUID、SGID、SBIT等的特性
    - `chmod 数字 目标文件或目录`,数字为相应二进制
    - `chmod [ugoa]+[+-=]+[rwx] 目标文件或目录`
  - 如果连同目录下所有文件或目录一同修改的话,命令可加入[-R](recursive递归)选项
  - `cp`:复制操作
    - `cp 源文件 目标文件`:会连同属性和权限一同复制
- 权限对目录或文件的意义
  |组件|内容|替代对象|r|w|x|
  |-|-|-|-|-|-|
  |文件|详细数据data|文件夹|读到文件内容|修改文件内容|执行文件内容|
  |目录|文件名|可分类抽屉|读到文件名|修改文件名、删除文件、移动目录内文件、目录|进入该目录的权限|
- 各用户对自己的家目录有rwx权限
- 文件类型
  - 常规文件(regular file)
    - 用[-]表示
    - 纯文本文件(ASCLL):可用`cat`命令读取
    - 二进制文件(binary):系统认识且可以执行的二进制命令
    - 数据文件(data):可用`last`命令读取,程序运行过程读取的数据文件
  - 目录文件(directory):[d]
  - 链接文件(link file):[l]
  - 设备与设备文件(device):通常在/dev目录下
    - 区块(block)设备文件:[b],一些存储数据,以提供系统随机存取的接口设备,如硬盘、软盘、U盘等
    - 字符(character)设备文件:[c],一些串行端口的接口设备,如键盘、鼠标等(特色为一次性读取)
  - 数据接口文件(sockets):[s],通常被用在网络上的数据交换,在/run、/tmp目录下常出现这种文件类型
  - 数据输送文件(FIFO,pipe)
    - [p],first-in-first-out,即管道,常用于多程序读取一个文件
  - socket与socket与进程(process)有关
- 常用文件扩展名
  - *.sh:脚本或批处理文件(scripts),用shell写成
  - *Z、*.tar、*.tar.gz、*.zip、*.tgz:经过打包的压缩文件,根据不同压缩软件而得名
  - *.html、*.php:html语法或php语法的网页文件
  - Linux内核常用文件名:vmlinuz
- 与Windows系统不同,文件是否可执行与是否有x权限和是否有可执行程序代码有关
- Linux文件命名以详细为目的,所以很多文件名很长
  - 单一目录或文件名最长为255字节,128个汉字以内

# Linux目录配置
- Linux目录配置依据:FHS(Filesystem Hierarchy Standard)标准
- FHS定义的目录
  - 可分享(shareable):能够分享给网络上其他主机挂载的目录
  - 不可分享(unshareable):自己机器上面运行的设备文件或是与程序有关的socket文件,与自身机器有关,不适合分享
  - 不变(static):不经常变动,如函数库、文件说明、系统管理员所管理的主机服务配置文件等
  - 可变动(variable):经常修改的数据,如日志文件、一般用户可自行接受的新闻组
- FHS定义的目录树(directory tree)
  - /(root,根目录):与启动系统有关
  - /usr(unix software resource):与软件安装/执行有关
  - /var(variable):与系统运行过程有关
  > 1、目录树的起始点为根目录
  > 2、每一个目录不止可使用本地分区的文件系统,还可以使用网络上的,可以通过挂载某特定目录来使用
  > 3、每一个文件在此目录树中的文件名(包括完整路径)都是独一无二的
- 根目录[6-1]
  - FHS要求必须存在的目录
    - /bin:在单人维护模式下还能够被使用的命令,如`cat`、`date`、`chmod`、`cp`等
    - /boot:启动会使用到的文件,包括内核文件、启动选项、启动所需配置文件等
    - /dev:任何设备与接口设备存放处
    - /etc:系统主要的配置文件几乎存放在此目录,建议不要放置可执行文件(binary)
      - /opt(FHS必要):存放第三方辅助软件/opt的相关配置文件
      - /X11(FHS建议):与X window有关的配置文件
      - /sgml(FHS建议):与SGML格式有关的各项配置文件
      - /xml(FHS建议):与XML格式有关的各项配置文件
    - /lib:放置在启动时会用到的函数库,以及/bin或/sbin下面的命令会调用的函数库
      - /modules(FHS必要):驱动程序
    - /media:放置可删除设备,如软盘、光盘、DVD
    - /mnt:暂时挂载某些额外设备
    - /opt:第三方辅助软件放置的目录
    - /run:系统启动后所产生的各项信息,可以使用内存来模拟
    - /sbin:启动过程所需要的,包括启动、修复、还原系统所需要的命令,还包括某些服务器软件程序,常见命令包括`fdisk`、`ifconfig`等.至于本机自行安装的软件所产生的系统执行文件(system binary),则放置在/usr/local/sbin/当中
    - /src:service缩写,一些网络服务启动之后,这些服务所需要使用的数据目录,如/srv/www/
    - /tmp:让一般用户或是正在执行的程序暂时放置文件的地方
    - /usr
    - /var:主要放置变动性的数据
  - FHS建议可存在的目录
    - /home:用户家目录存放位置
    - /lib<qual>:用来存放与/lib不同格式的二进制函数库,如支持64位的/lib64函数库等
    - /root:系统管理员(root)的家目录,进入单人维护模式,通过挂载根目录,也能够拥有root家目录,此目录应与根目录放置到同一分区
  - 其他重要目录
    - /lost+found:使用ext234文件系统格式才会产生的一个目录,目的在于当文件系统发生错误时,将一些遗失的片段放置到这个目录下
    - /proc:虚拟文件系统(virtual filesystem),如系统内核、进程信息(process)、外接设备的状态及网络状态.此目录下的数据都是在内存当中,本身不占硬盘容量
    - /sys:与/proc相似,主要记录内核与系统硬件信息相关的内容.包括目前已加载的内核模块与内核检测到的硬件设备信息等,不占用硬盘容量
  - 五个重要目录必须跟根目录放置在一起:/etc、/bin、/dev、/lib、/sbin
- /usr:安装时会占用较大硬盘容量
  - FHS要求必须存在的目录
    - /bin:和根目录/bin是同一个文件,其链接于此
    - /lib:和根目录/lib是同一个文件,其链接于此
    - /local:安装自己下载的软件
    - /sbin:和根目录/sbin是同一个文件,其链接于此
    - /share:主要放置只读的数据文件,当然还有共享文件,几乎都是文本文件.几乎不区分硬件架构,都可以读取
  - FHS建议可存在的目录
    - /games:与游戏相关的数据放置处
    - /include:c/c++等程序语言的头文件(header)与包含文件(include)放置处
    - /libexec:某些不被一般用户常用的执行文件或脚本(script)等,例如大部分X窗口下面的操作命令
    - /lib<qual>:和根目录/lib<qual>是同一个文件,其链接于此
    - /src:source,一般源代码放置处
- /var:在系统运行后才渐渐占用硬盘容量
  - FHS要求必须存在的目录
    - /cache:应用程序本身运行过程中会产生的一些缓存
    - /lib:软件运行过程中,需要使用到自己的数据文件,每个软件应有自己的目录
    - /lock:链接到根目录/run/lock,某些设备或文件资源只能同时被一个应用使用,则需要给其上锁
    - /log:放置日志文件,记录登录信息等
    - /mail:放置个人电子游戏,与/spool/mail互为链接文件
    - /run:链接到根目录/run,某些程序或服务启动后,会将它们的PID放置在此目录
    - /spool:通常放一些队列数据,就是排队等待其他程序使用的数据,被使用后通常被删除
- 路径
  - 绝对路径:由根目录开始写起的文件名或目录名称
  - 相对路径:由当前位置写起的文件或目录名称
    - [.]表示当前目录
    - [..]表示上一层目录
  - 执行本目录下的命令文件:`./文件名`

# 命令
- `uname`
  - 查看内核版本:`uname -r`
  - 查看操作系统的架构版本:`uname -m`
